// ============================================
// LOCATION REGISTRY (Codes + Languages)
// ============================================
// Client-safe mapping used by both UI and server logic.
// Keep language lists minimal and verified; default to ["en"].
// ============================================

export type LocationMetadata = {
  code: number
  languages: readonly string[]
  primaryLanguage: string
}

export const LOCATION_CODES = {
  AF: 2004,
  AL: 2008,
  DZ: 2012,
  AS: 2016,
  AD: 2020,
  AO: 2024,
  AI: 2660,
  AQ: 2010,
  AG: 2028,
  AR: 2032,
  AM: 2051,
  AW: 2533,
  AU: 2036,
  AT: 2040,
  AZ: 2031,
  BS: 2044,
  BH: 2048,
  BD: 2050,
  BB: 2052,
  BY: 2112,
  BE: 2056,
  BZ: 2084,
  BJ: 2204,
  BM: 2060,
  BT: 2064,
  BO: 2068,
  BA: 2070,
  BW: 2072,
  BR: 2076,
  BN: 2096,
  BG: 2100,
  BF: 2854,
  BI: 2108,
  KH: 2116,
  CM: 2120,
  CA: 2124,
  CV: 2132,
  KY: 2136,
  CF: 2140,
  TD: 2148,
  CL: 2152,
  CN: 2156,
  CO: 2170,
  KM: 2174,
  CG: 2178,
  CD: 2180,
  CK: 2184,
  CR: 2188,
  CI: 2384,
  HR: 2191,
  CU: 2192,
  CY: 2196,
  CZ: 2203,
  DK: 2208,
  DJ: 2262,
  DM: 2212,
  DO: 2214,
  EC: 2218,
  EG: 2818,
  SV: 2222,
  GQ: 2226,
  ER: 2232,
  EE: 2233,
  ET: 2231,
  FK: 2238,
  FO: 2234,
  FJ: 2242,
  FI: 2246,
  FR: 2250,
  GF: 2254,
  PF: 2258,
  GA: 2266,
  GM: 2270,
  GE: 2268,
  DE: 2276,
  GH: 2288,
  GI: 2292,
  GR: 2300,
  GL: 2304,
  GD: 2308,
  GP: 2312,
  GU: 2316,
  GT: 2320,
  GN: 2324,
  GW: 2624,
  GY: 2328,
  HT: 2332,
  HN: 2340,
  HK: 2344,
  HU: 2348,
  IS: 2352,
  IN: 2356,
  ID: 2360,
  IR: 2364,
  IQ: 2368,
  IE: 2372,
  IL: 2376,
  IT: 2380,
  JM: 2388,
  JP: 2392,
  JO: 2400,
  KZ: 2398,
  KE: 2404,
  KI: 2296,
  KP: 2408,
  KR: 2410,
  KW: 2414,
  KG: 2417,
  LA: 2418,
  LV: 2428,
  LB: 2422,
  LS: 2426,
  LR: 2430,
  LY: 2434,
  LI: 2438,
  LT: 2440,
  LU: 2442,
  MO: 2446,
  MK: 2807,
  MG: 2450,
  MW: 2454,
  MY: 2458,
  MV: 2462,
  ML: 2466,
  MT: 2470,
  MH: 2584,
  MQ: 2474,
  MR: 2478,
  MU: 2480,
  YT: 2175,
  MX: 2484,
  FM: 2583,
  MD: 2498,
  MC: 2492,
  MN: 2496,
  MS: 2500,
  MA: 2504,
  MZ: 2508,
  MM: 2104,
  NA: 2516,
  NR: 2520,
  NP: 2524,
  NL: 2528,
  NC: 2540,
  NZ: 2554,
  NI: 2558,
  NE: 2562,
  NG: 2566,
  NU: 2570,
  NF: 2574,
  MP: 2580,
  NO: 2578,
  OM: 2512,
  PK: 2586,
  PW: 2585,
  PS: 2275,
  PA: 2591,
  PG: 2598,
  PY: 2600,
  PE: 2604,
  PH: 2608,
  PN: 2612,
  PL: 2616,
  PT: 2620,
  PR: 2630,
  QA: 2634,
  RE: 2638,
  RO: 2642,
  RU: 2643,
  RW: 2646,
  SH: 2654,
  KN: 2659,
  LC: 2662,
  PM: 2666,
  VC: 2670,
  WS: 2882,
  SM: 2674,
  ST: 2678,
  SA: 2682,
  SN: 2686,
  RS: 2688,
  SC: 2690,
  SL: 2694,
  SG: 2702,
  SK: 2703,
  SI: 2705,
  SB: 2090,
  SO: 2706,
  ZA: 2710,
  GS: 2239,
  ES: 2724,
  LK: 2144,
  SD: 2736,
  SR: 2740,
  SJ: 2744,
  SZ: 2748,
  SE: 2752,
  CH: 2756,
  SY: 2760,
  TW: 2158,
  TJ: 2762,
  TZ: 2834,
  TH: 2764,
  TG: 2768,
  TK: 2772,
  TO: 2776,
  TT: 2780,
  TN: 2788,
  TR: 2792,
  TM: 2795,
  TC: 2796,
  TV: 2798,
  UG: 2800,
  UA: 2804,
  AE: 2784,
  GB: 2826,
  UK: 2826,
  US: 2840,
  UM: 2581,
  UY: 2858,
  UZ: 2860,
  VU: 2548,
  VA: 2336,
  VE: 2862,
  VN: 2704,
  VG: 2092,
  VI: 2850,
  WF: 2876,
  EH: 2732,
  YE: 2887,
  ZM: 2894,
  ZW: 2716,
} as const satisfies Record<string, number>

const DEFAULT_LANGUAGES = ["en"] as const

export const LOCATION_LANGUAGE_OVERRIDES: Record<string, readonly string[]> = {
  AE: ["ar", "en"],
  SA: ["ar", "en"],
  EG: ["ar", "en"],
  DZ: ["ar", "fr", "en"],
  MA: ["ar", "fr", "en"],
  TN: ["ar", "fr", "en"],
  IL: ["he", "en"],
  IR: ["fa", "en"],
  TR: ["tr", "en"],
  RU: ["ru", "en"],
  UA: ["uk", "en"],
  BY: ["ru", "en"],
  IN: ["en", "hi"],
  BD: ["bn", "en"],
  PK: ["ur", "en"],
  LK: ["si", "ta", "en"],
  NP: ["ne", "en"],
  TH: ["th", "en"],
  VN: ["vi", "en"],
  ID: ["id", "en"],
  MY: ["ms", "en"],
  PH: ["en", "tl"],
  SG: ["en", "zh", "ms", "ta"],
  CN: ["zh", "en"],
  TW: ["zh", "en"],
  HK: ["zh", "en"],
  JP: ["ja", "en"],
  KR: ["ko", "en"],
  FR: ["fr", "en"],
  BE: ["nl", "fr", "en"],
  CH: ["de", "fr", "it", "en"],
  DE: ["de", "en"],
  AT: ["de", "en"],
  NL: ["nl", "en"],
  IT: ["it", "en"],
  ES: ["es", "en"],
  PT: ["pt", "en"],
  BR: ["pt", "en"],
  MX: ["es", "en"],
  AR: ["es", "en"],
  CO: ["es", "en"],
  CL: ["es", "en"],
  PE: ["es", "en"],
  VE: ["es", "en"],
  UY: ["es", "en"],
  PY: ["es", "en"],
  BO: ["es", "en"],
  EC: ["es", "en"],
  CR: ["es", "en"],
  PA: ["es", "en"],
  GT: ["es", "en"],
  SV: ["es", "en"],
  HN: ["es", "en"],
  NI: ["es", "en"],
  DO: ["es", "en"],
  CU: ["es", "en"],
  PR: ["es", "en"],
  CA: ["en", "fr"],
  US: ["en", "es"],
  SE: ["sv", "en"],
  NO: ["no", "en"],
  DK: ["da", "en"],
  FI: ["fi", "en"],
  PL: ["pl", "en"],
  CZ: ["cs", "en"],
  SK: ["sk", "en"],
  HU: ["hu", "en"],
  RO: ["ro", "en"],
  BG: ["bg", "en"],
  GR: ["el", "en"],
  RS: ["sr", "en"],
  HR: ["hr", "en"],
  SI: ["sl", "en"],
  EE: ["et", "en"],
  LV: ["lv", "en"],
  LT: ["lt", "en"],
  IS: ["is", "en"],
} as const

export const LANGUAGE_LABELS: Record<string, string> = {
  en: "English",
  hi: "Hindi",
  pt: "Portuguese",
  es: "Spanish",
  fr: "French",
  de: "German",
  it: "Italian",
  ru: "Russian",
  zh: "Chinese",
  zh_cn: "Chinese (Simplified)",
  zh_tw: "Chinese (Traditional)",
  ja: "Japanese",
  ko: "Korean",
  ar: "Arabic",
  tr: "Turkish",
  nl: "Dutch",
  sv: "Swedish",
  no: "Norwegian",
  da: "Danish",
  fi: "Finnish",
  pl: "Polish",
  cs: "Czech",
  sk: "Slovak",
  hu: "Hungarian",
  ro: "Romanian",
  bg: "Bulgarian",
  el: "Greek",
  uk: "Ukrainian",
  he: "Hebrew",
  iw: "Hebrew",
  fa: "Persian",
  ur: "Urdu",
  bn: "Bengali",
  ta: "Tamil",
  te: "Telugu",
  gu: "Gujarati",
  kn: "Kannada",
  ml: "Malayalam",
  mr: "Marathi",
  pa: "Punjabi",
  si: "Sinhala",
  ne: "Nepali",
  th: "Thai",
  vi: "Vietnamese",
  id: "Indonesian",
  ms: "Malay",
  tl: "Filipino",
  fil: "Filipino",
  sr: "Serbian",
  hr: "Croatian",
  sl: "Slovenian",
  et: "Estonian",
  lv: "Latvian",
  lt: "Lithuanian",
  is: "Icelandic",
  ca: "Catalan",
} as const

export const LANGUAGE_OPTIONS = Object.entries(LANGUAGE_LABELS)
  .map(([code, label]) => ({ code, label }))
  .sort((a, b) => a.label.localeCompare(b.label))

export const LOCATION_REGISTRY: Record<string, LocationMetadata> = Object.fromEntries(
  Object.entries(LOCATION_CODES).map(([iso, code]) => [
    iso,
    (() => {
      const languages = LOCATION_LANGUAGE_OVERRIDES[iso] ?? DEFAULT_LANGUAGES
      const primaryLanguage = languages.includes("en") ? "en" : languages[0] ?? "en"
      return { code, languages, primaryLanguage }
    })(),
  ])
) as Record<string, LocationMetadata>

export function getNumericLocationCode(isoCode: string): number {
  const normalized = isoCode?.trim().toUpperCase()
  if (!normalized) return LOCATION_REGISTRY.US.code

  const entry = LOCATION_REGISTRY[normalized]
  return entry?.code ?? LOCATION_REGISTRY.US.code
}

export function getSupportedLanguages(isoCode: string): string[] {
  const normalized = isoCode?.trim().toUpperCase()
  const entry = normalized ? LOCATION_REGISTRY[normalized] : undefined
  return entry?.languages ? [...entry.languages] : [...DEFAULT_LANGUAGES]
}

export function getPrimaryLanguage(isoCode: string): string {
  const normalized = isoCode?.trim().toUpperCase()
  const entry = normalized ? LOCATION_REGISTRY[normalized] : undefined
  return entry?.primaryLanguage ?? "en"
}

export function getLanguageLabel(code: string): string {
  const normalized = code.trim().toLowerCase().replace("-", "_")
  return LANGUAGE_LABELS[normalized] ?? normalized.toUpperCase()
}
